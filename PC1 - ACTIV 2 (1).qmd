---
title: "PC1 - Actividad 2"
author: Bautista Benites Bruno Edgar
format: html
---

## Práctica Calificada 1 - Actividad 2

## 1. Importando el dataset asignado

```{r}
library(here)
library(rio)
```

```{r}
data_diabetes = import(here("data", "diabetes.csv"))
```

## **2. Proceso de limpieza del dataset "diabetes".**

### Instalamos y cargamos los paquetes que usaremos

```{r}
install.packages("tidyverse")
install.packages("janitor")
```

```{r}
library(tidyverse)
library(janitor)
```

### A - Corrección de nombres de variables

```{r}
names(data_diabetes)
```

```{r}
data_diabetes_1 = clean_names(data_diabetes)
```

### B - Renombrando variables

```{r}
names(data_diabetes_1)
```

```{r}
data_diabetes_2 <- rename(data_diabetes_1,
    Núm_Embarazo = num_embarazos,
    Glucosa_2h = glucosa_2h, 
    Presión_Sanguínea = presion_sanguinea, 
    Pliegue_Tríceps = pliegue_triceps, 
    Insulina_2h = insulina_2h, 
    IMC = imc, 
    Historial_Diabetes = historial_diabetes, 
    Edad = edad, 
    Diabetes_5a = diabetes_5a)
```

```{r}
names(data_diabetes_2)
```

### C - Eliminando columnas o celdas vacías

```{r}
data_diabetes_3 = mutate_if(data_diabetes_2, is.character, list(~na_if(.,"")))
```

### D - Corrigiendo errores de tipeo

```{r}
data_diabetes_3 |> count(Núm_Embarazo)
data_diabetes_3 |> count(Glucosa_2h)
data_diabetes_3 |> count(Presión_Sanguínea)
data_diabetes_3 |> count(Pliegue_Tríceps)
data_diabetes_3 |> count(Insulina_2h)
data_diabetes_3 |> count(IMC)
data_diabetes_3 |> count(Historial_Diabetes)
data_diabetes_3 |> count(Edad)
data_diabetes_3 |> count(Diabetes_5a)
```

***#Variable Diabetes_5a***

```{r}
data_diabetes_4 = data_diabetes_3 |>
  mutate(
    Diabetes_5a =
      case_when(
        Diabetes_5a == "negativo" ~ "Negativo",
        Diabetes_5a == "positivo" ~ "Positivo",
        TRUE ~ Diabetes_5a))
```

### E - Colapsando niveles

***#Variable IMC***

```{r}
data_diabetes_5 <- data_diabetes_4 %>%
  mutate(
    IMC_cat = case_when(
      IMC < 18.5 ~ "Bajo peso",
      IMC >= 18.5 & IMC < 25 ~ "Normal",
      IMC >= 25 & IMC < 30 ~ "Sobrepeso",
      IMC >= 30 & IMC < 35 ~ "Obesidad I",
      IMC >= 35 & IMC < 40 ~ "Obesidad II",
      IMC >= 40 ~ "Obesidad III",
      TRUE ~ NA_character_
    )
  ) %>%
  mutate(IMC_cat = factor(IMC_cat, 
                          levels = c("Bajo peso", "Normal", "Sobrepeso", 
                                     "Obesidad I", "Obesidad II", "Obesidad III")))
```

*Verificamos nuestro resultado:*

```{r}
data_diabetes_5 |> count(IMC_cat)
```

***#Variable Edad***

```{r}
data_diabetes_6 <- data_diabetes_5 %>%
  mutate(
    Grupo_etario = case_when(
      Edad >= 18 & Edad <= 29 ~ "18-29",
      Edad >= 30 & Edad <= 39 ~ "30-39",
      Edad >= 40 & Edad <= 49 ~ "40-49",
      Edad >= 50 & Edad <= 59 ~ "50-59",
      Edad >= 60             ~ "60+",
      TRUE ~ NA_character_
    )
  ) %>%
  mutate(Grupo_etario = factor(Grupo_etario, 
                             levels = c("18-29", "30-39", "40-49", "50-59", "60+")))

```

*Verificamos nuestro resultado*

```{r}
data_diabetes_6 |> count(Grupo_etario)
```

## 3. Exportando un dataframe en formato csv

Al tener mi data limpia y ordenada ya la puedo exportar al formato csv para poder utilizar en próximos proyectos, en este caso sería "data_diabetes_6" la data a exportar.

```{r}
write.csv(data_diabetes_6, "data_diabetes_6.csv", row.names = FALSE)
```
